<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CardioML - Heart Disease Prediction</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #e74c3c; --primary-dark: #c0392b; --secondary: #3498db;
            --success: #27ae60; --dark: #2c3e50; --light: #ecf0f1; --white: #ffffff;
            --gradient: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            --shadow: 0 10px 40px rgba(0, 0, 0, 0.1); --shadow-lg: 0 20px 60px rgba(0, 0, 0, 0.15);
        }
        body { font-family: 'Inter', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; color: var(--dark); }
        .navbar { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); padding: 1rem 2rem; position: fixed; width: 100%; top: 0; z-index: 1000; box-shadow: var(--shadow); }
        .nav-container { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .logo { display: flex; align-items: center; gap: 0.75rem; font-size: 1.5rem; font-weight: 700; color: var(--primary); text-decoration: none; }
        .logo i { font-size: 2rem; animation: heartbeat 1.5s infinite; }
        @keyframes heartbeat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
        .nav-links { display: flex; gap: 2rem; }
        .nav-links a { text-decoration: none; color: var(--dark); font-weight: 500; transition: color 0.3s; }
        .nav-links a:hover { color: var(--primary); }
        .hero { padding: 8rem 2rem 3rem; text-align: center; color: white; }
        .hero h1 { font-size: 3rem; font-weight: 700; margin-bottom: 1rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.2); }
        .hero p { font-size: 1.2rem; opacity: 0.9; max-width: 600px; margin: 0 auto; }
        .main-container { max-width: 1200px; margin: 0 auto; padding: 0 2rem 4rem; display: grid; grid-template-columns: 1fr 400px; gap: 2rem; }
        @media (max-width: 1000px) { .main-container { grid-template-columns: 1fr; } }
        .form-card { background: white; border-radius: 20px; box-shadow: var(--shadow-lg); overflow: hidden; }
        .form-header { background: var(--gradient); color: white; padding: 1.5rem 2rem; }
        .form-header h2 { font-size: 1.5rem; display: flex; align-items: center; gap: 0.75rem; }
        .form-body { padding: 2rem; }
        .form-section { margin-bottom: 2rem; }
        .section-title { font-size: 1rem; font-weight: 600; color: var(--primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--light); display: flex; align-items: center; gap: 0.5rem; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 1rem; }
        .form-group { position: relative; }
        .form-group label { display: block; font-size: 0.85rem; font-weight: 500; color: var(--dark); margin-bottom: 0.4rem; }
        .form-group .unit { font-size: 0.75rem; color: #888; font-weight: 400; }
        .form-group input { width: 100%; padding: 0.75rem 1rem; border: 2px solid var(--light); border-radius: 10px; font-size: 1rem; font-family: inherit; transition: all 0.3s; background: white; }
        .form-group input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.1); }
        .form-group input:hover { border-color: #bdc3c7; }
        .submit-btn { width: 100%; padding: 1rem 2rem; background: var(--gradient); color: white; border: none; border-radius: 12px; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center; gap: 0.75rem; margin-top: 1rem; }
        .submit-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(231, 76, 60, 0.3); }
        .submit-btn.loading { pointer-events: none; opacity: 0.8; }
        .submit-btn .spinner { display: none; width: 20px; height: 20px; border: 2px solid rgba(255,255,255,0.3); border-top-color: white; border-radius: 50%; animation: spin 0.8s linear infinite; }
        .submit-btn.loading .spinner { display: block; }
        .submit-btn.loading .btn-text { display: none; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .results-panel { position: sticky; top: 100px; height: fit-content; }
        .results-card { background: white; border-radius: 20px; box-shadow: var(--shadow-lg); overflow: hidden; }
        .results-header { background: var(--dark); color: white; padding: 1.5rem 2rem; }
        .results-header h2 { font-size: 1.3rem; display: flex; align-items: center; gap: 0.75rem; }
        .results-body { padding: 2rem; }
        .results-placeholder { text-align: center; color: #888; padding: 3rem 1rem; }
        .results-placeholder i { font-size: 4rem; margin-bottom: 1rem; opacity: 0.3; }
        .result-display { display: none; }
        .result-display.active { display: block; }
        .risk-indicator { text-align: center; padding: 2rem; border-radius: 15px; margin-bottom: 1.5rem; }
        .risk-indicator.low-risk { background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%); color: white; }
        .risk-indicator.high-risk { background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white; }
        .risk-indicator i { font-size: 3rem; margin-bottom: 1rem; }
        .risk-indicator h3 { font-size: 1.5rem; margin-bottom: 0.5rem; }
        .probability-bars { margin-top: 1.5rem; }
        .probability-item { margin-bottom: 1rem; }
        .probability-label { display: flex; justify-content: space-between; margin-bottom: 0.5rem; font-weight: 500; }
        .probability-bar { height: 12px; background: var(--light); border-radius: 6px; overflow: hidden; }
        .probability-fill { height: 100%; border-radius: 6px; transition: width 0.8s ease; }
        .probability-fill.healthy { background: linear-gradient(90deg, #27ae60, #2ecc71); }
        .probability-fill.disease { background: linear-gradient(90deg, #e74c3c, #c0392b); }
        .info-card { background: white; border-radius: 20px; box-shadow: var(--shadow-lg); padding: 1.5rem; margin-top: 1.5rem; }
        .info-card h3 { color: var(--primary); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; font-size: 1rem; }
        .info-card ul { list-style: none; }
        .info-card li { padding: 0.4rem 0; display: flex; align-items: center; gap: 0.75rem; color: #555; font-size: 0.9rem; }
        .info-card li i { color: var(--primary); width: 16px; }
        .footer { text-align: center; padding: 2rem; color: rgba(255,255,255,0.8); }
        .disclaimer { background: rgba(255, 255, 255, 0.1); border-radius: 10px; padding: 1rem; margin-top: 1rem; font-size: 0.85rem; color: rgba(255,255,255,0.8); }
        @media (max-width: 768px) { .hero h1 { font-size: 2rem; } .form-grid { grid-template-columns: 1fr; } .nav-links { display: none; } .main-container { padding: 0 1rem 2rem; } }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="/" class="logo"><i class="fas fa-heartbeat"></i> CardioML</a>
            <div class="nav-links">
                <a href="/"><i class="fas fa-home"></i> Home</a>
                <a href="/about"><i class="fas fa-info-circle"></i> About</a>
            </div>
        </div>
    </nav>

    <section class="hero">
        <h1><i class="fas fa-heartbeat"></i> Heart Disease Prediction</h1>
        <p>Advanced machine learning model with 86% accuracy to assess cardiovascular disease risk</p>
    </section>

    <main class="main-container">
        <div class="form-card">
            <div class="form-header">
                <h2><i class="fas fa-clipboard-list"></i> Patient Information</h2>
            </div>
            <div class="form-body">
                <form id="predictionForm">
                    <div class="form-section">
                        <h3 class="section-title"><i class="fas fa-heartbeat"></i> Vital Signs</h3>
                        <div class="form-grid">
                            {% for feature in features %}
                                {% if feature.name == 'heart rate' %}
                                <div class="form-group">
                                    <label>{{ feature.label }} {% if feature.unit %}<span class="unit">({{ feature.unit }})</span>{% endif %}</label>
                                    <input type="number" name="{{ feature.name }}" id="{{ feature.name }}" value="{{ feature.default }}"
                                           {% if feature.min is defined %}min="{{ feature.min }}"{% endif %}
                                           {% if feature.max is defined %}max="{{ feature.max }}"{% endif %}
                                           {% if feature.step is defined %}step="{{ feature.step }}"{% else %}step="any"{% endif %}>
                                </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>

                    <div class="form-section">
                        <h3 class="section-title"><i class="fas fa-vial"></i> Blood Tests</h3>
                        <div class="form-grid">
                            {% for feature in features %}
                                {% if feature.name in ['RDW', 'Leucocyte', 'PT', 'INR'] %}
                                <div class="form-group">
                                    <label>{{ feature.label }} {% if feature.unit %}<span class="unit">({{ feature.unit }})</span>{% endif %}</label>
                                    <input type="number" name="{{ feature.name }}" id="{{ feature.name }}" value="{{ feature.default }}"
                                           {% if feature.min is defined %}min="{{ feature.min }}"{% endif %}
                                           {% if feature.max is defined %}max="{{ feature.max }}"{% endif %}
                                           {% if feature.step is defined %}step="{{ feature.step }}"{% else %}step="any"{% endif %}>
                                </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>

                    <div class="form-section">
                        <h3 class="section-title"><i class="fas fa-flask"></i> Biomarkers & Chemistry</h3>
                        <div class="form-grid">
                            {% for feature in features %}
                                {% if feature.name in ['Urea nitrogen', 'Blood potassium', 'Anion gap', 'Lactic acid'] %}
                                <div class="form-group">
                                    <label>{{ feature.label }} {% if feature.unit %}<span class="unit">({{ feature.unit }})</span>{% endif %}</label>
                                    <input type="number" name="{{ feature.name }}" id="{{ feature.name }}" value="{{ feature.default }}"
                                           {% if feature.min is defined %}min="{{ feature.min }}"{% endif %}
                                           {% if feature.max is defined %}max="{{ feature.max }}"{% endif %}
                                           {% if feature.step is defined %}step="{{ feature.step }}"{% else %}step="any"{% endif %}>
                                </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>

                    <button type="submit" class="submit-btn" id="submitBtn">
                        <span class="btn-text"><i class="fas fa-search"></i> Analyze Risk</span>
                        <div class="spinner"></div>
                    </button>
                </form>
            </div>
        </div>

        <div class="results-panel">
            <div class="results-card">
                <div class="results-header">
                    <h2><i class="fas fa-chart-pie"></i> Prediction Results</h2>
                </div>
                <div class="results-body">
                    <div class="results-placeholder" id="placeholder">
                        <i class="fas fa-heartbeat"></i>
                        <p>Enter patient information and click "Analyze Risk" to see the prediction</p>
                    </div>
                    <div class="result-display" id="resultDisplay">
                        <div class="risk-indicator" id="riskIndicator">
                            <i class="fas fa-heart"></i>
                            <h3 id="riskLevel">-</h3>
                            <p id="riskMessage">-</p>
                        </div>
                        <div class="probability-bars">
                            <div class="probability-item">
                                <div class="probability-label">
                                    <span><i class="fas fa-heart" style="color: #27ae60;"></i> Healthy</span>
                                    <span id="healthyPercent">-</span>
                                </div>
                                <div class="probability-bar">
                                    <div class="probability-fill healthy" id="healthyBar" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="probability-item">
                                <div class="probability-label">
                                    <span><i class="fas fa-heart-broken" style="color: #e74c3c;"></i> Heart Disease</span>
                                    <span id="diseasePercent">-</span>
                                </div>
                                <div class="probability-bar">
                                    <div class="probability-fill disease" id="diseaseBar" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="info-card">
                <h3><i class="fas fa-info-circle"></i> About This Model</h3>
                <ul>
                    <li><i class="fas fa-check"></i> Logistic Regression algorithm</li>
                    <li><i class="fas fa-check"></i> 86.05% test accuracy</li>
                    <li><i class="fas fa-check"></i> Trained on 1,177 patients</li>
                    <li><i class="fas fa-check"></i> Uses 9 high-correlation features</li>
                </ul>
            </div>

            <div class="disclaimer">
                <i class="fas fa-exclamation-triangle"></i>
                <strong>Disclaimer:</strong> This tool is for educational purposes only.
            </div>
        </div>
    </main>

    <footer class="footer">
        <p>ðŸ«€ CardioML - Developed by <strong>zayyanCPU</strong></p>
    </footer>

    <script>
        document.getElementById('predictionForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.classList.add('loading');
            const formData = new FormData(this);
            try {
                const response = await fetch('/predict', { method: 'POST', body: formData });
                const result = await response.json();
                if (result.error) { alert('Error: ' + result.error); return; }
                document.getElementById('placeholder').style.display = 'none';
                document.getElementById('resultDisplay').classList.add('active');
                const riskIndicator = document.getElementById('riskIndicator');
                if (result.prediction === 1) {
                    riskIndicator.className = 'risk-indicator high-risk';
                    riskIndicator.innerHTML = `<i class="fas fa-heart-broken"></i><h3>High Risk</h3><p>The model indicates elevated risk of heart disease</p>`;
                } else {
                    riskIndicator.className = 'risk-indicator low-risk';
                    riskIndicator.innerHTML = `<i class="fas fa-heart"></i><h3>Low Risk</h3><p>The model indicates lower risk of heart disease</p>`;
                }
                document.getElementById('healthyPercent').textContent = result.probability_no_disease + '%';
                document.getElementById('diseasePercent').textContent = result.probability_disease + '%';
                setTimeout(() => {
                    document.getElementById('healthyBar').style.width = result.probability_no_disease + '%';
                    document.getElementById('diseaseBar').style.width = result.probability_disease + '%';
                }, 100);
            } catch (error) { alert('Error making prediction. Please try again.'); console.error(error); }
            finally { submitBtn.classList.remove('loading'); }
        });
    </script>
</body>
</html>
